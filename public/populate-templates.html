
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Template Database Population</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .status { padding: 10px; margin: 10px 0; border-radius: 4px; }
        .success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .info { background: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; }
        .warning { background: #fff3cd; color: #856404; border: 1px solid #ffeaa7; }
        button { padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; }
        button:hover { background: #0056b3; }
        button:disabled { background: #6c757d; cursor: not-allowed; }
        #log { background: #f8f9fa; padding: 15px; border: 1px solid #dee2e6; border-radius: 4px; font-family: monospace; white-space: pre-wrap; max-height: 400px; overflow-y: auto; }
    </style>
</head>
<body>
    <h1>üè† Family Compass - Template Database Population</h1>
    
    <div class="status info">
        <strong>Instructions:</strong><br>
        1. Make sure you're logged into the app in another tab<br>
        2. Click "Populate Templates" to add standard household templates<br>
        3. Check the log for progress and any errors
    </div>
    
    <button id="populateBtn" onclick="populateTemplates()">Populate Templates</button>
    <button id="testBtn" onclick="testConnection()">Test Firebase Connection</button>
    
    <h3>Log Output:</h3>
    <div id="log"></div>

    <!-- Firebase v9 SDK -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/11.8.0/firebase-app.js';
        import { getFirestore, collection, addDoc, getDocs, query, where } from 'https://www.gstatic.com/firebasejs/11.8.0/firebase-firestore.js';

        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyAAKx8jNgMq8XNhHfWQhQJzXzJxTjhQ0Qc",
            authDomain: "family-fun-app.firebaseapp.com",
            projectId: "family-fun-app",
            storageBucket: "family-fun-app.firebasestorage.app",
            messagingSenderId: "123456789",
            appId: "1:123456789:web:abc123def456"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        window.db = db;
        window.collection = collection;
        window.addDoc = addDoc;
        window.getDocs = getDocs;
        window.query = query;
        window.where = where;

        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const logElement = document.getElementById('log');
            const prefix = type === 'error' ? '‚ùå' : type === 'success' ? '‚úÖ' : type === 'warning' ? '‚ö†Ô∏è' : '‚ÑπÔ∏è';
            logElement.textContent += `[${timestamp}] ${prefix} ${message}\n`;
            logElement.scrollTop = logElement.scrollHeight;
        }

        window.log = log;

        // Standard household chore templates
        const templates = [
            {
                id: 'morning-routine',
                name: 'Morning Routine',
                description: 'Essential morning tasks to start the day organized and fresh',
                category: 'daily_routines',
                difficulty: 'beginner',
                isOfficial: true,
                isPublic: true,
                popularity: 95,
                rating: 4.8,
                reviewCount: 23,
                targetFamilySize: [2, 6],
                totalEstimatedTime: 25,
                tags: ['morning', 'daily', 'bedroom', 'personal'],
                version: 1,
                chores: [
                    {
                        title: 'Make Your Bed',
                        description: 'Straighten sheets, fluff pillows, and arrange bedding neatly',
                        type: 'organization',
                        difficulty: 'easy',
                        basePoints: 5,
                        estimatedDuration: 3,
                        frequency: 1,
                        cooldownHours: 20,
                        importance: 'medium',
                        isOptional: false,
                        canModifyPoints: true,
                        canModifySchedule: true
                    },
                    {
                        title: 'Tidy Bedroom',
                        description: 'Put clothes away, clear nightstand, and straighten room',
                        type: 'cleaning',
                        difficulty: 'easy', 
                        basePoints: 8,
                        estimatedDuration: 10,
                        frequency: 1,
                        cooldownHours: 20,
                        importance: 'medium',
                        isOptional: false,
                        canModifyPoints: true,
                        canModifySchedule: true
                    }
                ],
                createdAt: new Date().toISOString(),
                lastUpdated: new Date().toISOString()
            },
            {
                id: 'kitchen-cleanup',
                name: 'Kitchen Daily Clean',
                description: 'Daily kitchen cleaning and organization routine',
                category: 'daily_routines',
                difficulty: 'beginner',
                isOfficial: true,
                isPublic: true,
                popularity: 88,
                rating: 4.6,
                reviewCount: 31,
                targetFamilySize: [2, 8],
                totalEstimatedTime: 30,
                tags: ['kitchen', 'cleaning', 'daily', 'dishes'],
                version: 1,
                chores: [
                    {
                        title: 'Empty Dishwasher',
                        description: 'Unload clean dishes and put them away in proper places',
                        type: 'cleaning',
                        difficulty: 'easy',
                        basePoints: 10,
                        estimatedDuration: 8,
                        frequency: 1,
                        cooldownHours: 12,
                        importance: 'high',
                        isOptional: false,
                        canModifyPoints: true,
                        canModifySchedule: true
                    },
                    {
                        title: 'Wipe Down Counters',
                        description: 'Clean and disinfect all kitchen countertops and surfaces',
                        type: 'cleaning',
                        difficulty: 'easy',
                        basePoints: 8,
                        estimatedDuration: 10,
                        frequency: 1,
                        cooldownHours: 24,
                        importance: 'high',
                        isOptional: false,
                        canModifyPoints: true,
                        canModifySchedule: true
                    },
                    {
                        title: 'Clean Kitchen Table',
                        description: 'Clear, wipe, and sanitize the dining/kitchen table',
                        type: 'cleaning',
                        difficulty: 'easy',
                        basePoints: 6,
                        estimatedDuration: 5,
                        frequency: 1,
                        cooldownHours: 12,
                        importance: 'medium',
                        isOptional: false,
                        canModifyPoints: true,
                        canModifySchedule: true
                    }
                ],
                createdAt: new Date().toISOString(),
                lastUpdated: new Date().toISOString()
            },
            {
                id: 'bathroom-weekly',
                name: 'Bathroom Weekly Clean',
                description: 'Complete bathroom cleaning and maintenance routine',
                category: 'weekly_maintenance',
                difficulty: 'intermediate',
                isOfficial: true,
                isPublic: true,
                popularity: 82,
                rating: 4.4,
                reviewCount: 18,
                targetFamilySize: [2, 6],
                totalEstimatedTime: 35,
                tags: ['bathroom', 'cleaning', 'weekly', 'hygiene'],
                version: 1,
                chores: [
                    {
                        title: 'Clean Toilet',
                        description: 'Scrub toilet bowl, wipe seat, and clean exterior',
                        type: 'cleaning',
                        difficulty: 'medium',
                        basePoints: 15,
                        estimatedDuration: 10,
                        frequency: 7,
                        cooldownHours: 168,
                        importance: 'high',
                        isOptional: false,
                        canModifyPoints: true,
                        canModifySchedule: true
                    },
                    {
                        title: 'Wipe Mirror and Sink',
                        description: 'Clean bathroom mirror and wipe down sink area',
                        type: 'cleaning',
                        difficulty: 'easy',
                        basePoints: 8,
                        estimatedDuration: 8,
                        frequency: 3,
                        cooldownHours: 72,
                        importance: 'medium',
                        isOptional: false,
                        canModifyPoints: true,
                        canModifySchedule: true
                    }
                ],
                createdAt: new Date().toISOString(),
                lastUpdated: new Date().toISOString()
            },
            {
                id: 'living-room-tidy',
                name: 'Living Room Daily Tidy',
                description: 'Daily living room tidying and organization',
                category: 'daily_routines',
                difficulty: 'beginner',
                isOfficial: true,
                isPublic: true,
                popularity: 75,
                rating: 4.3,
                reviewCount: 26,
                targetFamilySize: [2, 8],
                totalEstimatedTime: 15,
                tags: ['living room', 'organization', 'daily', 'family'],
                version: 1,
                chores: [
                    {
                        title: 'Pick Up Clutter',
                        description: 'Return items to their proper places and clear surfaces',
                        type: 'organization',
                        difficulty: 'easy',
                        basePoints: 8,
                        estimatedDuration: 10,
                        frequency: 1,
                        cooldownHours: 24,
                        importance: 'medium',
                        isOptional: false,
                        canModifyPoints: true,
                        canModifySchedule: true
                    },
                    {
                        title: 'Fluff Couch Cushions',
                        description: 'Arrange and fluff sofa cushions and throw pillows',
                        type: 'organization',
                        difficulty: 'easy',
                        basePoints: 3,
                        estimatedDuration: 3,
                        frequency: 1,
                        cooldownHours: 24,
                        importance: 'low',
                        isOptional: true,
                        canModifyPoints: true,
                        canModifySchedule: true
                    }
                ],
                createdAt: new Date().toISOString(),
                lastUpdated: new Date().toISOString()
            },
            {
                id: 'quick-pickup',
                name: '15-Minute House Pickup',
                description: 'Quick daily house-wide tidying routine',
                category: 'daily_routines',
                difficulty: 'beginner',
                isOfficial: true,
                isPublic: true,
                popularity: 85,
                rating: 4.7,
                reviewCount: 42,
                targetFamilySize: [2, 8],
                totalEstimatedTime: 15,
                tags: ['daily', 'quick', 'whole house', 'family'],
                version: 1,
                chores: [
                    {
                        title: 'Living Areas Pickup',
                        description: 'Quick tidy of living room, dining room, and common areas',
                        type: 'organization',
                        difficulty: 'easy',
                        basePoints: 8,
                        estimatedDuration: 5,
                        frequency: 1,
                        cooldownHours: 24,
                        importance: 'medium',
                        isOptional: false,
                        canModifyPoints: true,
                        canModifySchedule: true
                    },
                    {
                        title: 'Kitchen Quick Clean',
                        description: 'Load dishwasher, wipe counters, and put items away',
                        type: 'cleaning',
                        difficulty: 'easy',
                        basePoints: 10,
                        estimatedDuration: 7,
                        frequency: 1,
                        cooldownHours: 24,
                        importance: 'high',
                        isOptional: false,
                        canModifyPoints: true,
                        canModifySchedule: true
                    }
                ],
                createdAt: new Date().toISOString(),
                lastUpdated: new Date().toISOString()
            }
        ];

        window.testConnection = async function() {
            const testBtn = document.getElementById('testBtn');
            testBtn.disabled = true;
            
            try {
                log('Testing Firebase connection...');
                const templatesRef = collection(db, 'choreTemplates');
                const snapshot = await getDocs(templatesRef);
                log(`‚úÖ Connection successful! Found ${snapshot.size} existing templates.`, 'success');
            } catch (error) {
                log(`‚ùå Connection failed: ${error.message}`, 'error');
            } finally {
                testBtn.disabled = false;
            }
        };

        window.populateTemplates = async function() {
            const populateBtn = document.getElementById('populateBtn');
            populateBtn.disabled = true;
            
            try {
                log('üè† Starting template database population...');
                
                const templatesRef = collection(db, 'choreTemplates');
                let addedCount = 0;
                let skippedCount = 0;

                for (const template of templates) {
                    try {
                        // Check if template already exists
                        const existingQuery = query(templatesRef, where('id', '==', template.id));
                        const existingSnap = await getDocs(existingQuery);

                        if (existingSnap.size > 0) {
                            log(`‚è≠Ô∏è Skipping "${template.name}" - already exists`, 'warning');
                            skippedCount++;
                            continue;
                        }

                        // Add template to Firestore
                        const docRef = await addDoc(templatesRef, template);
                        log(`‚úÖ Added "${template.name}" (${template.category}) - ${docRef.id}`, 'success');
                        addedCount++;

                    } catch (error) {
                        log(`‚ùå Error adding template "${template.name}": ${error.message}`, 'error');
                    }
                }

                log(`\nüìä Population Summary:`, 'info');
                log(`‚úÖ Templates added: ${addedCount}`, 'success');
                log(`‚è≠Ô∏è Templates skipped: ${skippedCount}`, 'warning');
                
                if (addedCount > 0) {
                    log(`\nüéâ Template database population completed successfully!`, 'success');
                    log(`Templates are now available in the Family Compass app.`, 'info');
                } else {
                    log(`\n‚ú® No new templates needed - database is already populated!`, 'info');
                }

            } catch (error) {
                log(`üí• Fatal error during template population: ${error.message}`, 'error');
            } finally {
                populateBtn.disabled = false;
            }
        };

        log('‚úÖ Firebase initialized successfully. Ready to populate templates!', 'success');
    </script>
</body>
</html>
